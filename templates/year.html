<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>{{title}}</title>
	<link rel="stylesheet" href="/css/foundation.css">
	<link rel="stylesheet" href="/css/custom.css">
</head>
<body>
	<header class="top-bar">
		<div class="top-bar-right">
			<ul class="menu">
				<li><a href="/">Home</a></li>
				<li><a href="{{prevLink}}">Prev</a></li>
				<li><a href="{{nextLink}}">Next</a></li>
			</ul>
		</div>
	</header>
	<main class="grid-container">
		<h1 class="h2">{{pageTitle}}</h1>
		<table class="hover">
			<thead>
				<tr>
					<th>Country</th>
					<th>Freedom Index</th>
				</tr>
			</thead>
			<tbody>
				{{tableRows}}
			</tbody>
		</table>
		<section style="margin-top: 24px;">
			<canvas id="yearChart" height="120"></canvas>
		</section>
	</main>
	<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
	<script type="application/json" id="yearLabels">{{chartLabels}}</script>
	<script type="application/json" id="yearValues">{{chartData}}</script>
	<script>
	(function() {
		function safeParse(id) {
			try {
				const el = document.getElementById(id);
				if (!el) return [];
				const txt = (el.textContent || '').trim();
				if (!txt) return [];
				return JSON.parse(txt);
			} catch (_) { return []; }
		}
		const labels = safeParse('yearLabels');
		const values = safeParse('yearValues');
		const ctx = document.getElementById('yearChart');
		if (!ctx) return;
		new Chart(ctx, {
			type: 'bar',
			data: {
				labels,
				datasets: [{
					label: 'Freedom Index',
					data: values,
					backgroundColor: 'rgba(54, 162, 235, 0.5)',
					borderColor: 'rgba(54, 162, 235, 1)',
					borderWidth: 1
				}]
			},
			options: {
				responsive: true,
				plugins: {
					legend: { position: 'top' },
					title: { display: true, text: 'Top Freedom Index Scores' }
				},
				scales: {
					y: { beginAtZero: true }
				}
			}
		});
	})();
	</script>
	</body>
</html>
